# -*- coding: utf-8 -*-
"""formulario.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZTUaUBborPNJ90qX9pQc8Dg1axVt_rgA
"""

import streamlit as st
import gspread
from google.oauth2.service_account import Credentials
from datetime import datetime

# =====================
# CONFIGURAÇÕES
# =====================
SHEET_ID = "11JaCc4y-htBW-cxbvbMBV28GHYlORbMM6345TSaXcgQ"
NOME_ABA = "Respostas"

scope = [
    "https://www.googleapis.com/auth/spreadsheets",
    "https://www.googleapis.com/auth/drive"
]

# =====================
# GOOGLE SHEETS
# =====================
service_account_info = dict(st.secrets["gcp_service_account"])

credentials = Credentials.from_service_account_info(
    service_account_info,
    scopes=scope
)

gc = gspread.authorize(credentials)
sheet = gc.open_by_key(SHEET_ID).worksheet(NOME_ABA)

# =====================
# INTERFACE
# =====================
st.title("Check-list de Acompanhamento")

with st.form("checklist_form"):

    # ---- Identificação
    st.subheader("Identificação")



    hierarquia = {
        "ADRIELE DA SILVA SOUZA": {
            "ANA PICOLLI": ['LOJA BALNEARIO CAMBORIU - SC', 'LOJA CHAPECO - SC',
       'LOJA FLORIANOPOLIS - SC', 'LOJA ITAJAI - SC',
       'LOJA JOINVILLE - SC', 'LOJA PALHOÇA - SC', 'LOJA SAO JOSE - SC'],
            "DANIELA DO CARMO CAMPARA": ['LOJA ERECHIM - RS', 'LOJA CARAZINHO - RS', 'LOJA CRUZ ALTA - RS',
       'LOJA PASSO FUNDO - RS', 'LOJA PASSO FUNDO 2 - RS',
       'LOJA SOLEDADE - RS', 'LOJA CACHOEIRA DO SUL - RS',
       'LOJA SANTA MARIA - RS', 'LOJA LAJEADO - RS',
       'LOJA VENANCIO AIRES - RS'],
            "FABIOLA DAL ROSSO": ['LOJA IJUI 1 - RS', 'LOJA SANTA ROSA - RS',
       'LOJA SANTO ÂNGELO - RS', 'LOJA ALEGRETE - RS', 'LOJA ITAQUI - RS',
       'LOJA ROSARIO DO SUL - RS', 'LOJA SANTIAGO  - RS',
       'LOJA SAO BORJA - RS', 'LOJA SÃO GABRIEL - RS',
       'LOJA URUGUAIANA - RS'],
            "JOSIANE DE SOUZA MONTEIRO DOS SANTOS": ['LOJA CAMPO BOM - RS', 'LOJA IGREJINHA - RS',
       'LOJA PORTO ALEGRE - ASSIS BRASIL - RS',
       'LOJA PORTO ALEGRE - VIGARIO - RS', 'LOJA ROLANTE - RS',
       'LOJA SANTO ANTONIO DA PATRULHA - RS', 'LOJA SAPIRANGA - RS',
       'LOJA TAQUARA - RS', 'LOJA TRAMANDAI - RS',
       'LOJA TRES COROAS - RS', 'LOJA CACHOEIRINHA - RS'],
            "JULIE BARBOSA": ['LOJA ARARANGUA - SC', 'LOJA CRICIUMA - SC', 'LOJA LAGUNA - SC',
       'LOJA TUBARÃO - SC', 'LOJA TORRES - RS'],
            "LARISSA OLIVEIRA BARBOZA": ['LOJA BUTIA - RS', 'LOJA CHARQUEADAS - RS', 'LOJA GRAVATAI - RS',
       'LOJA PORTO ALEGRE - AZENHA - RS',
       'LOJA PORTO ALEGRE - BORGES - RS',
       'LOJA PORTO ALEGRE - OSVALDO ARANHA I - RS',
       'LOJA SALGADO FILHO - RS', 'LOJA SAO JERONIMO - RS',
       'LOJA VIAMAO - RS', 'LOJA PORTO ALEGRE - OTTO NIEMEYER - RS',
       'LOJA PORTO ALEGRE - RESTINGA - RS'],
            "THAMIRES IZIDORO DO NASCIMENTO SILVA": ['LOJA CANOAS - CENTRO - RS', 'LOJA CANOAS - GUAJUVIRAS - RS',
       'LOJA ESTEIO - RS', 'LOJA NOVO HAMBURGO - RS',
       'LOJA NOVO HAMBURGO 2 - RS', 'LOJA SAO LEOPOLDO II - RS',
       'LOJA SAPUCAIA DO SUL I - RS', 'LOJA SAPUCAIA DO SUL II - RS',
       'LOJA BENTO GONCALVES - RS', 'LOJA CAXIAS DO SUL - RS',
       'LOJA MONTENEGRO - RS', 'LOJA PORTAO - RS'],
            "VIVIANE FAGUNDES DE MELLO": ['LOJA SAO LEOPOLDO - RS', 'LOJA GUAIBA - RS',
       'LOJA PORTO ALEGRE - CRISTOVAO COLOMBO - RS',
       'LOJA PROTASIO ALVES - RS', 'LOJA CAMAQUA - RS',
       'LOJA PELOTAS - RS', 'LOJA RIO GRANDE - RS',
       'LOJA SAO LOURENÇO - RS', 'LOJA TAPES - RS',
       'LOJA PORTO ALEGRE - MARECHAL - RS']
        },

        "MAYARA NOVAIS LOPES": {
            "ADRIELE FERNANDA VIEIRA DA SILVA": ['LOJA GOIANIA - GO', 'LOJA SETOR CAMPINAS - GO',
       'LOJA SETOR GARAVELO - GO', 'LOJA CAMPO GRANDE - MS',
       'LOJA CUIABA - MT', 'LOJA PALMAS - TO'],
            "ROSELY RAMALHO DA SILVA DIAS": ['LOJA MANAUS - ALVORADA - AM', 'LOJA MANAUS - CHAPADA - AM',
       'LOJA MANAUS - CIDADE NOVA - AM', 'LOJA MANAUS - COMPENSA - AM',
       'LOJA MANAUS - EDUCANDOS - AM',
       'LOJA MANAUS - SAO JOSE OPERARIO - AM '],
            "JESSICA FERREIRA FIGUEIREDO": ['LOJA  JUIZ DE FORA - MG', 'LOJA CATAGUASES - MG',
       'LOJA CONSELHEIRO LAFAIETE-MG', 'LOJA MURIAE - MG',
       'LOJA SANTOS DUMONT - MG', 'LOJA UBA - MG', 'LOJA VIÇOSA - MG',
       'LOJA SAO JOAO DEL REI - MG', 'LOJA BARBACENA - MG'],
            "LUCIANE DA SILVA FONSECA PINHEIRO": ['LOJA ANJO DA GUARDA - MA', 'LOJA JOAO PAULO - MA',
       'LOJA PAÇO DO LUMIAR - MA', 'LOJA SAO JOSE DE RIBAMAR - MA',
       'LOJA SAO LUIS - MA', 'LOJA TERESINA II - PI',
       'LOJA TIRIRICAL - MA', 'LOJA BACABAL - MA'],
            "NAYRA BASTOS DA SILVA": ['LOJA ANANINDEUA - PA', 'LOJA BELEM - PA', 'LOJA BRAGANÇA - PA',
       'LOJA ICOARACI - PA', 'LOJA MACAPA - AP'],
            "RENATO SOUZA DO ESPIRITO SANTO LANGA": ['LOJA BELO HORIZONTE - MG', 'LOJA CONTAGEM - MG',
       'LOJA SANTA LUZIA - MG', 'LOJA BETIM - MG',
       'LOJA BELO HORIZONTE - BARRO PRETO - MG',
       'LOJA BELO HORIZONTE - BETANIA - MG',
       'LOJA BELO HORIZONTE - VENDA NOVA - MG'],
            "KAICK FERNANDES PEIXOTO": ['LOJA JARU - RO', 'LOJA JI PARANA - RO', 'LOJA ARIQUEMES - RO',
       'LOJA VILHENA - RO', 'LOJA PORTO VELHO - RO'],
            "SILVANA PINTO CABRAL": ['LOJA MARABÁ - PA', 'LOJA DE AÇAILÂNDIA - MA',
       'LOJA DE IMPERATRIZ - MA', 'LOJA ARAGUAINA - TO',
       'LOJA BARRA DO CORDA - MA', 'LOJA BALSAS - MA']
        },
        "CINARA REGINA KEMERICH": {
            "ANDREY COSTA DA ROCHA": ['LOJA ARARAQUARA - SP', 'LOJA BAURU - SP', 'LOJA JAU - SP',
       'LOJA MARILIA - SP', 'LOJA OURINHOS - SP',
       'LOJA RIBEIRAO PRETO - SP', 'LOJA SAO JOSE DO RIO PRETO - SP'],
            "THAINA MARCHI CONEJO": ['LOJA CAMPINAS - SP', 'LOJA LIMEIRA - SP', 'LOJA PIRACICABA - SP',
       'LOJA RIO CLARO - SP', 'LOJA SÃO CARLOS - SP', 'LOJA SUMARE - SP',
       'LOJA VALINHOS - SP'],
            "JOAO GUALBERTO BRAZ JUNIOR": ['LOJA ALMIRANTE TAMANDARÉ - PR', 'LOJA CURITIBA - PR',
       'LOJA FAZENDA RIO GRANDE - PR', 'LOJA PARANAGUA - PR',
       'LOJA PONTA GROSSA - PR', 'LOJA SAO JOSÉ DOS PINHAIS',
       'LOJA ARAUCARIA - PR', 'LOJA CAMPO LARGO - PR',
       'LOJA COLOMBO - PR', 'LOJA PINHAIS - PR'],
            "COORDENAÇÃO SP II": ['LOJA ATIBAIA - SP', 'LOJA FRANCISCO MORATO - SP',
       'LOJA FRANCO DA ROCHA - SP', 'LOJA JUNDIAI - SP',
       'LOJA OSASCO - SP', 'LOJA SAO ROQUE - SP'],
            "MIRIAM DE SALLES BARBIERI": ['LOJA SUZANO SP', 'LOJA ITAQUAQUECETUBA - SP',
       'LOJA ITAQUERA - SP', 'LOJA MATEUS - SP', 'LOJA SAO MIGUEL - SP',
       'LOJA SAO PAULO - PENHA - SP', 'LOJA TATUAPE - SP',
       'LOJA GUARULHOS - SP', 'LOJA SAO BENTO - SP'],
            "SILVANA DE FATIMA CENCI": ['LOJA DIADEMA - SP', 'LOJA MAUA - SP', 'LOJA MOGI DAS CRUZES - SP',
       'LOJA PRAIA GRANDE - SP', 'LOJA SANTO ANDRE - SP',
       'LOJA SANTOS - SP', 'LOJA SAO CAETANO - SP',
       'LOJA SAO VICENTE - SP'],
            "CARLOS VINICIUS TEIXEIRA FRANCA": ['LOJA CAMPO MOURÃO - PR', 'LOJA CASCAVEL - PR',
       'LOJA FOZ DO IGUAÇU - PR', 'LOJA LONDRINA - PR',
       'LOJA MARINGA 1 - PR', 'LOJA MARINGA 2 - PR', 'LOJA TOLEDO - PR',
       'LOJA UMUARAMA - PR']
        },
          "CRISTIANE CARVALHO GEBELATTO": {
              "BRENO ROCHA HONORATO DA SILVA": ['LOJA CONJ CEARA - FORTALEZA - CE', 'LOJA FORTALEZA - CE',
       'LOJA MESSEJANA - CE', 'LOJA PARANGABA - CE',
       'LOJA MARACANAU - CE', 'LOJA MARANGUAPE - CE', 'LOJA CAUCAIA - CE',
       'LOJA ITAPIPOCA - CE', 'LOJA SOBRAL - CE', 'LOJA GUAIUBA - CE'],
              "JESSICA ANDRADE DOS SANTOS": ['LOJA LAURO DE FREITAS - BA', 'LOJA CANDEIAS - BA',
       'LOJA FEIRA DE SANTANA - BA', 'LOJA SANTO ANTONIO DE JESUS - BA',
       'LOJA VALENCA - BA', 'LOJA DIAS DAVILA - BA'],
              "JOSE WELLINGTON DE SOUSA COSTA": ['LOJA ALMENARA - MG', 'LOJA EUNAPOLIS - BA', 'LOJA ILHEUS - BA',
       'LOJA ITABUNA - BA', 'LOJA PORTO SEGURO - BA',
       'LOJA VITORIA DA CONQUISTA - BA', 'LOJA DIVISOPOLIS - MG',
       'LOJA PEDRA AZUL - MG', 'LOJA JEQUIE - BA'],
              "LUANA SANTOS FURMANEK": ['LOJA CABULA - SALVADOR', 'LOJA CAJAZEIRAS -  BA',
       'LOJA ITAPUÃ - SALVADOR', 'LOJA SALVADOR - BA',
       'LOJA SALVADOR - COMERCIO', 'LOJA SAO MARCOS - BA',
       'LOJA ARACAJU - SE', 'LOJA MACEIO - AL', 'LOJA CAMACARI - BA'],
              "RUANA VIRGINIA DA SILVA SANTOS": ['LOJA JUAZEIRO DO NORTE - CE', 'LOJA QUIXADA - CE',
       'LOJA QUIXERAMOBIM - CE', 'LOJA CRATO - CE', 'LOJA IGUATU - CE'],
              "WHANDERSON MATHEUS ARAUJO DA COSTA": ['LOJA AFOGADOS - RECIFE', 'LOJA BAYEUX - PB',
       'LOJA CAMPINA GRANDE - PB', 'LOJA CARUARU - PE',
       'LOJA CRUZ DAS ARMAS - PB', 'LOJA JOAO PESSOA - PB',
       'LOJA MANGABEIRA - PB', 'LOJA NATAL - RN',
       'LOJA NATAL - CIDADE ALTA - RN', 'LOJA RECIFE - PE',
       'LOJA SANTA RITA - PB']
        },
        "THAYSA SANDIM DE SOUZA": {
            "GISELLE MORAES SCHNEIDER": ['LOJA CARIACICA - ES', 'LOJA GUARAPARI - ES', 'LOJA LINHARES - ES',
       'LOJA SERRA - ES', 'LOJA VILA VELHA - ES', 'LOJA VITORIA - ES',
       'LOJA CACHOEIRO DE ITAPEMIRIM - ES', 'LOJA LARANJEIRAS - ES'],
            "LOSANGELA HONORIO DE OLIVEIRA": ['LOJA ANGRA DOS REIS - RJ', 'LOJA BARRA DO PIRAI - RJ',
       'LOJA BARRA MANSA - RJ', 'LOJA CRUZEIRO - SP',
       'LOJA GUARATINGUETA - SP', 'LOJA LORENA - SP', 'LOJA RESENDE - RJ',
       'LOJA SAO JOSE DOS CAMPOS - SP', 'LOJA TAUBATE - SP',
       'LOJA VOLTA REDONDA - RJ', 'LOJA VOLTA REDONDA II - RJ',
       'LOJA TRES RIOS - RJ'],
            "MARILIA GABRIELA LOPES FARIA": ['LOJA BANGU - RJ', 'LOJA CAMPO GRANDE - RJ', 'LOJA MADUREIRA - RJ',
       'LOJA MEIER - RJ'],
            "MARIA EDUARDA DELGADO MENESES": ['LOJA DUQUE DE CAXIAS - RJ', 'LOJA NITEROI - RJ',
       'LOJA NOVA IGUAÇU - RJ', 'LOJA RIO DE JANEIRO - RJ',
       'LOJA SAO GONCALO - RJ', 'LOJA ITABORAI - RJ'],
            "YASMIM APARECIDA DOS ANJOS PARANHOS": ['LOJA MACAE - RJ', 'LOJA RIO DAS OSTRAS - RJ',
       'LOJA SAQUAREMA - RJ', 'LOJA CABO FRIO - RJ',
       'LOJA CAMPO DOS GOYTACAZES 1 - RJ', 'LOJA ARARUAMA - RJ',
       'LOJA SAO PEDRO DA ALDEIA - RJ']
        }
    }

    regional = st.selectbox(
        "Regional",
        options=["Selecione"] + list(hierarquia.keys())
    )

    coordenador = None
    loja = None

    if regional != "Selecione":

        coordenador = st.selectbox(
            "Coordenador Regional",
            options=["Selecione"] + list(hierarquia[regional].keys())
        )

        if coordenador != "Selecione":

            loja = st.selectbox(
                "Loja",
                options=["Selecione"] + hierarquia[regional][coordenador]
            )

    supervisor = st.text_input("Supervisor de Loja")

    st.divider()

    # ---- Perguntas
    st.subheader("Perguntas")

    perguntas = [
        "01. Analisa os indicadores quantitativos diariamente D-1 e INTRADAY",
        "02. Aplica o CLAV semanalmente com base em evidências",
        "03. Registra e compartilha os resultados com o consultor",
        "04. Aplica e mantem atualizado o diagnóstico do colaborador, usando as informações de maneira estratégica",
        "05. Realiza microtreinamentos com a equipe",
        "06. Está presente corrigindo execuções em tempo real",
        "07. Utiliza o Teatro de Vendas",
        "08. Aplica dinâmicas rápidas e criativas durante o dia",
        "09. Aplica Feedback SAR com frequência",
        "10. Supervisor consegue ser claro quanto as evidências de aplicação que serão verificadas nos próximos atendimentos/dias.",
        "11. A equipe domina técnica de pesquisa (perguntas abertas e SPIN)",
        "12. A equipe sabe destacar características e benefícios dos produtos comercializados",
        "13. A equipe sabe destacar as vantagens e benefícios da empresa para o cliente",
        "14. A equipe em loja possui total domínio nas técnicas de neutralização de objeções e as utilizam quando necessária nos atendimentos",
        "15. A equipe em loja tem habilidade necessária para realizar o cross de todos os produtos para cada cliente.",
        "16. Os Consultores pedem indicação ao final do atendimento",
        "17. Os Consultores seguem os passos da jornada",
        "18. Reconhece avanços da equipe",
        "19. Utiliza linguagem positiva e motivadora",
        "20. Supervisor conhece sonhos e objetivos de cada colaborador",
        "21. Acompanha indicadores técnicos semanalmente",
        "22. Analisa comportamento da equipe com base em dados (CLAV e Observação Direta)",
        "23. Garante que o que foi treinado esteja sendo aplicado através da observação de evidências de aplicação.",
        "24. Faz reuniões 1:1 com os consultores semanalmente",
        "25. Atualiza e utiliza o PDI individual customizando as ações de treinamento em loja",
        "26. Supervisor tem ciência de todas as pendências de contrato, e propostas negadas",
        "27. Consultores sabem sua meta diária, acumulado, tkm, etc e sabem a importância destes números",
        "28. O Supervisor de Loja possui de forma clara e objetiva o controle da informação de agendamentos",
        "29. A equipe na loja conhece e domina todos os campos e funcionalidades de todos os sistemas operacionais?",
        "30. A equipe da loja possui boa apresentação pessoal, de acordo com as políticas e normas de conduta da empresa",
        "31. O Supervisor de Loja organiza e acompanha diariamente o rodízio de acionamentos de sua equipe?",
        "32. O Supervisor de Loja tem acompanhado os comunicados internos, lendo entendendo, repassando e orientando sua equipe, garantindo entendimento e a execução imediata?",
        "33. O Supervisor acompanha e trata o não pagamento da 1ª parcela débito.",
        "34. O Supervisor atua diariamente sobre os saldos de portabilidade - aprovando, cancelando e analisando os motivos dos saldos cancelados.",
        "35. O Supervisor de Loja conhece a particularidade de sua carteira de clientes de FF, como potencial, população da cidade e carteira de cliente ativos e inativos por produto?",
        "36. Validação do QL - O Supervisor faz a gestão de posições disponíveis x vagas abertas",
        "37. A equipe mantém assiduidade em loja (pontualidade e frequência).",
        "38. Supervisor faz a gestão e controle das horas extras diariamente?",
        "39. Todos os chamados necessários para reparo, manutenção, infraestrutura, etc... estão abertos e aguardando solução."
    ]

    respostas = []

    for i, pergunta in enumerate(perguntas, start=1):
        resposta = st.radio(
            pergunta,
            ["Sim", "Não"],
            horizontal=True,
            key=f"q{i}"
        )
        respostas.append(resposta)

    st.divider()

    enviar = st.form_submit_button("Enviar Checklist")

# =====================
# SALVAR NO GOOGLE SHEETS
# =====================
if enviar:

    if (
        regional == "Selecione" or
        coordenador == "Selecione" or
        loja == "Selecione" or
        not supervisor.strip()
    ):
        st.error("Preencha todos os campos obrigatórios antes de enviar.")
        st.stop()

    linha = [
        datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
        regional,
        coordenador,
        loja,
        supervisor,
        *respostas
    ]

    sheet.append_row(linha)

    st.success("Checklist enviado com sucesso ✅")
